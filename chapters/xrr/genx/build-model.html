
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Build a more complex model &#8212; X-Ray Reflectivity on SIRIUS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/xrr/genx/build-model';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Unknown model: where to start?" href="unknown-model.html" />
    <link rel="prev" title="Export" href="export.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/resized-logo-SIRIUS.jpg" class="logo__image only-light" alt="X-Ray Reflectivity on SIRIUS - Home"/>
    <img src="../../../_static/resized-logo-SIRIUS.jpg" class="logo__image only-dark pst-js-only" alt="X-Ray Reflectivity on SIRIUS - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">XRR</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="about.html">Analyzing XRR with GenX</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="import-data.html">Import data</a></li>
<li class="toctree-l2"><a class="reference internal" href="beam-parameters.html">Beam parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample-parameters.html">Sample parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit.html">Fit the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="export.html">Export</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Build a more complex model</a></li>
<li class="toctree-l2"><a class="reference internal" href="unknown-model.html">Unknown model: where to start?</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Other examples &amp; tutorial data</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../extra/references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GIWAXS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../giwaxs/gidvis/about.html">Analyzing GIWAXS with GIDVis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/getting-started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/import-data.html">Import data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/beam-parameters.html">Beam parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/convert-q-space.html">Convert to q space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/merge.html">Merge images to remove dead zones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/calibration.html">Calibration with a reference sample (optional)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/powder-plot.html">Powder plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/integration.html">In-plane and out-of-plane integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/indexation.html">Indexation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/export-save.html">Save the project &amp; export images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../giwaxs/gidvis/troubleshooting.html">Troubleshooting &amp; tutorial data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../giwaxs/extra/references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">XRF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../xrf/pymca/about.html">Analyzing XRF with PyMca</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../xrf/pymca/import-data.html">Import &amp; visualize data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xrf/pymca/fit-data.html">Fit the spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xrf/pymca/kinetics.html">Batch fitting for kinetics analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xrf/pymca/calibration.html">Optional: energy calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xrf/pymca/troubleshooting.html">Troubleshooting &amp; tutorial data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../xrf/extra/references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../appendices/bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ArnaudHemmerle/xrr_on_sirius" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ArnaudHemmerle/xrr_on_sirius/issues/new?title=Issue%20on%20page%20%2Fchapters/xrr/genx/build-model.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/chapters/xrr/genx/build-model.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Build a more complex model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-the-lipid">Model the lipid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fill-the-sample-parameters">Fill the sample parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-layer">Tail layer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness-d"><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#formula-f"><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#density-rm-dens"><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#roughness-rm-sigma"><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#head-layer">Head layer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-phase">Sub-phase</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-with-the-parameters">Playing with the parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#start-the-fit">Start the fit</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="build-a-more-complex-model">
<span id="content-build-model"></span><h1>Build a more complex model<a class="headerlink" href="#build-a-more-complex-model" title="Link to this heading">#</a></h1>
<p>Now we will proceed with a more complex system than a simple liquid-gas interface. We will build the model step-by-step and estimate the initial guesses for the various parameters.</p>
<p>The data correspond to a monolayer of the phospholipid DPPS (1,2-Dipalmitoyl-sn-glycero-3-phosphoserine, 16:0/16:0 PS), at the helium-water interface, at an area-per-molecule of 0.38 nm<span class="math notranslate nohighlight">\(^2\)</span> (surface pressure of 40 mN/m). The data file can be downloaded <a class="reference download internal" download="" href="../../../_downloads/e97627fd772fa3601692673085b50c00/SIRIUS_2024_09_20_4556-4640_XRR.dat"><span class="xref download myst">here</span></a> (right-click&gt;Save link as). We will start with a simple GenX file where the data have already been imported, available <a class="reference download internal" download="" href="../../../_downloads/0344c8f9d08e2952e5f80ccc83fa3115/dpps_init.hgx"><span class="xref download myst">here</span></a>.</p>
<section id="model-the-lipid">
<h2>Model the lipid<a class="headerlink" href="#model-the-lipid" title="Link to this heading">#</a></h2>
<p>The signal measured in XRR is dictated by electron density <strong>contrast</strong> between the different layers. As such, it would be incorrect to model the lipid as a single block, as the aliphatic chains and the PS head exhibit a strong density contrast. Therefore, we will model our system with the following layers, from top to bottom:</p>
<ul class="simple">
<li><p>a semi-infinite medium of Helium (considered as vacuum),</p></li>
<li><p>a layer for the aliphatic tails,</p></li>
<li><p>a layer for the PS heads,</p></li>
<li><p>a semi-infinite sub-phase of water.</p></li>
</ul>
<p><img alt="" src="../../../_images/build-model-dpps.png" /></p>
</section>
<section id="fill-the-sample-parameters">
<h2>Fill the sample parameters<a class="headerlink" href="#fill-the-sample-parameters" title="Link to this heading">#</a></h2>
<p>Go to the <code class="docutils literal notranslate"><span class="pre">Sample</span></code> tab, click on <code class="docutils literal notranslate"><span class="pre">Sub</span></code>, and then on the icon <code class="docutils literal notranslate"><span class="pre">Insert</span> <span class="pre">a</span> <span class="pre">Stack</span></code>.</p>
<p><img alt="" src="../../../_images/build-model-insert-stack.png" /></p>
<p>Give it the name <code class="docutils literal notranslate"><span class="pre">dpps</span></code>. Now, within this stack, insert a first layer for the tails. Click on the stack <code class="docutils literal notranslate"><span class="pre">dpps</span></code>, then on the icon <code class="docutils literal notranslate"><span class="pre">Insert</span> <span class="pre">a</span> <span class="pre">Layer</span></code>.</p>
<p><img alt="" src="../../../_images/build-model-insert-layer.png" /></p>
<section id="tail-layer">
<h3>Tail layer<a class="headerlink" href="#tail-layer" title="Link to this heading">#</a></h3>
<p>Name this first layer <code class="docutils literal notranslate"><span class="pre">tail</span></code>. We will estimate the initial value of each parameter as follows.</p>
<section id="thickness-d">
<h4><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em><a class="headerlink" href="#thickness-d" title="Link to this heading">#</a></h4>
<p>A good starting point for the thickness of the tail layer is the theoretical length of an elongated aliphatic chain with <span class="math notranslate nohighlight">\(n\)</span> carbons in all-trans conformation, given by <span id="id1">[<a class="reference internal" href="../../appendices/bibliography.html#id20" title="Jacob Israelachvili. Intermolecular and Surface Forces. Academic press, 2011.">8</a>, <a class="reference internal" href="../../appendices/bibliography.html#id46" title="Charles Tanford. The Hydrophobic Effect: Formation of Micelles and Biological. J.Wiley, 1980.">9</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[
L_{\rm max}[{\rm nm}] = 0.126n + 0.146
\]</div>
<p>or, considering gauche defects:</p>
<div class="math notranslate nohighlight">
\[
L_{\rm max}[{\rm nm}] = 0.095n + 0.146.
\]</div>
<p>In this case, we have 16 C per chain, yielding <span class="math notranslate nohighlight">\(L_{\rm max} = 22\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>. We can set the initial guess to <span class="math notranslate nohighlight">\(d = 22\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span> and designate <code class="docutils literal notranslate"><span class="pre">d</span></code> as a fitting parameter.</p>
</section>
<section id="formula-f">
<h4><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em><a class="headerlink" href="#formula-f" title="Link to this heading">#</a></h4>
<p>In our model, the chains are composed of 35 C, 67 H, and 4 O atoms. The formula to input in the <code class="docutils literal notranslate"><span class="pre">f</span></code> box is <code class="docutils literal notranslate"><span class="pre">35*fp.C+67*fp.H+4*fp.O</span></code>. Do not set <code class="docutils literal notranslate"><span class="pre">f</span></code> as a fitting parameter.</p>
</section>
<section id="density-rm-dens">
<h4><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em><a class="headerlink" href="#density-rm-dens" title="Link to this heading">#</a></h4>
<p>We can use the area per molecule from the Langmuir trough <span class="math notranslate nohighlight">\({\cal A} = 38\)</span> <span class="math notranslate nohighlight">\({\rm A}^2\)</span> and the estimated layer thickness <span class="math notranslate nohighlight">\(d = 22\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span> to calculate the density. Since we consider two chains per molecule, the density in GenX units is:</p>
<div class="math notranslate nohighlight">
\[
{\rm dens} = \frac{1}{{\cal A} \cdot L} = \frac{1}{38 \times 22} = 0.0012.
\]</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">dens</span></code> as a fitting parameter.</p>
</section>
<section id="roughness-rm-sigma">
<h4><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em><a class="headerlink" href="#roughness-rm-sigma" title="Link to this heading">#</a></h4>
<p>A good initial guess for the roughness is the value obtained for water, i.e., <span class="math notranslate nohighlight">\({\rm sigma} = 3\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>. Set <code class="docutils literal notranslate"><span class="pre">sigma</span></code> as a fitting parameter.</p>
</section>
</section>
<section id="head-layer">
<h3>Head layer<a class="headerlink" href="#head-layer" title="Link to this heading">#</a></h3>
<p>Add a second layer, name it <code class="docutils literal notranslate"><span class="pre">head</span></code>, and <strong>check the position of the layer in the stack</strong>. The order should be from top to bottom: helium, tail, head, water. If the layer is not correctly positioned, select it and use the arrow icons to move it up or down.</p>
<section id="id2">
<h4><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Looking at the chemical drawing of our molecule, we can estimate the thickness to be around 5 <span class="math notranslate nohighlight">\(\rm A\)</span>. Set <span class="math notranslate nohighlight">\(d = 5\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span> and designate <code class="docutils literal notranslate"><span class="pre">d</span></code> as a fitting parameter.</p>
</section>
<section id="id3">
<h4><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>In our model, the heads are composed of 3 C, 6 H, 6 O, 1 P, 1 Na, and 1 N atoms. The formula to input in the <code class="docutils literal notranslate"><span class="pre">f</span></code> box is: <code class="docutils literal notranslate"><span class="pre">3*fp.C+6*fp.H+6*fp.O+1*fp.P+1*fp.Na+1*fp.N</span></code>. Do not set <code class="docutils literal notranslate"><span class="pre">f</span></code> as a fitting parameter.</p>
</section>
<section id="id4">
<h4><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Use the same approach as before to calculate the density:</p>
<div class="math notranslate nohighlight">
\[
{\rm dens} = \frac{1}{{\cal A} \cdot L} = \frac{1}{38 \times 5} = 0.0053.
\]</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">dens</span></code> as a fitting parameter.</p>
</section>
<section id="id5">
<h4><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em><a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>As before, set <span class="math notranslate nohighlight">\({\rm sigma} = 3\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>. Set <code class="docutils literal notranslate"><span class="pre">sigma</span></code> as a fitting parameter.</p>
</section>
</section>
<section id="sub-phase">
<h3>Sub-phase<a class="headerlink" href="#sub-phase" title="Link to this heading">#</a></h3>
<p>You need to set the roughness of the water sub-phase to <span class="math notranslate nohighlight">\(3\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>, and set it as a fitting parameter.</p>
<p>Your sample tab should look like this:
<img alt="" src="../../../_images/build-model-sample-done.png" /></p>
<p>If you’ve missed any steps, you can download the updated file <a class="reference download internal" download="" href="../../../_downloads/6d1fcfcb1d78e7bfe0daefe07cd71865/dpps_ready_for_fit.hgx"><span class="xref download myst">here</span></a>.</p>
</section>
</section>
<section id="playing-with-the-parameters">
<h2>Playing with the parameters<a class="headerlink" href="#playing-with-the-parameters" title="Link to this heading">#</a></h2>
<p>Go to the <code class="docutils literal notranslate"><span class="pre">Grid</span></code> tab. You’ll notice that all the parameters that were defined as fitting parameters are listed here. First, simulate the curves with your initial guesses.</p>
<p><img alt="" src="../../../_images/build-model-first-simu.png" /></p>
<p>You can see that the first dip in your model appears at a slightly larger q vector compared to the data. This typically suggests that the thickness of a layer is underestimated. The initial guess is close enough to the data to obtain a reasonable fit, but we will refine it further as an exercise.</p>
<p>We know that we are already near the maximum possible length for the chains. Thus, the thickness to adjust is likely that of the head layer. The initial guess of <span class="math notranslate nohighlight">\(5\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span> is a bit low, as indicated by measurements from a simple molecular model using the software <a class="reference external" href="https://avogadro.cc/">Avogadro</a>, which suggests a thickness of approximately <span class="math notranslate nohighlight">\(8\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>:</p>
<p><img alt="" src="../../../_images/build-model-avogadro.png" /></p>
<p>Try setting the head thickness to <span class="math notranslate nohighlight">\(d=7\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span> instead of <span class="math notranslate nohighlight">\(5\)</span>. This yields a slightly better fit. Use this opportunity to experiment with all the individual parameters to observe their effects on the curve.</p>
<p><img alt="" src="../../../_images/build-model-adjust-length.png" /></p>
<p>Notice that the new value is outside the default min/max range. GenX applies a constrained min/max range by default. Adjust these ranges to reasonable values as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma_{\rm tail}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{\rm head}\)</span> between <span class="math notranslate nohighlight">\(2\)</span> and <span class="math notranslate nohighlight">\(6\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{\rm water}\)</span> between <span class="math notranslate nohighlight">\(2\)</span> and <span class="math notranslate nohighlight">\(4\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(d_{\rm tail}\)</span> between <span class="math notranslate nohighlight">\(16\)</span> and <span class="math notranslate nohighlight">\(25\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(d_{\rm head}\)</span> between <span class="math notranslate nohighlight">\(5\)</span> and <span class="math notranslate nohighlight">\(11\)</span> <span class="math notranslate nohighlight">\(\rm A\)</span>.</p></li>
</ul>
<p>For now, keep the density values unchanged.</p>
<p><img alt="" src="../../../_images/build-model-adjust-range.png" /></p>
</section>
<section id="start-the-fit">
<span id="content-build-model-fit"></span><h2>Start the fit<a class="headerlink" href="#start-the-fit" title="Link to this heading">#</a></h2>
<p>Start the fit by clicking the Arrow icon in the top bar. After some time, you’ll notice that the parameters stop evolving. Click the Stop icon and keep the fit results. Simulate the results once to confirm that the current set of parameters corresponds to the best-fit values. You should now see that the model matches the data perfectly.</p>
<p><img alt="" src="../../../_images/build-model-best-fit.png" /></p>
<p><img alt="" src="../../../_images/build-model-best-fit-sld.png" /></p>
<p><strong>Be careful</strong>, this does not necessarily mean that you have solved the structure of your sample. You have found one set of parameters that fit the data, but there is no guarantee that another set of parameters would not fit the curve equally well (an inherent limitation of XRR).</p>
<p>Finally, click on the calculator icon to estimate the error for each parameter.</p>
<p>If you’ve missed any steps, you can download the updated file <a class="reference download internal" download="" href="../../../_downloads/5d42472193d0b9313ed33e59c7892872/dpps_fit_done.hgx"><span class="xref download myst">here</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/xrr/genx"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="export.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Export</p>
      </div>
    </a>
    <a class="right-next"
       href="unknown-model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unknown model: where to start?</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-the-lipid">Model the lipid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fill-the-sample-parameters">Fill the sample parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-layer">Tail layer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness-d"><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#formula-f"><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#density-rm-dens"><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#roughness-rm-sigma"><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#head-layer">Head layer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><em>Thickness <span class="math notranslate nohighlight">\(d\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><em>Formula <span class="math notranslate nohighlight">\(f\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><em>Density <span class="math notranslate nohighlight">\(\rm dens\)</span></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><em>Roughness <span class="math notranslate nohighlight">\(\rm sigma\)</span></em></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-phase">Sub-phase</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-with-the-parameters">Playing with the parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#start-the-fit">Start the fit</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Arnaud HEMMERLE (Synchrotron SOLEIL)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>